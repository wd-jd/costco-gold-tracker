<!DOCTYPE html>
<html>
<head>
    <title>Gold Check</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 50px; }
        #result { margin: 20px; padding: 20px; border: 1px solid #ccc; border-radius: 8px; min-height: 50px; }
        .in-stock { color: green; font-weight: bold; font-size: 1.5rem; }
        .out-of-stock { color: red; }
        button { padding: 10px 20px; cursor: pointer; background: #0060A9; color: white; border: none; border-radius: 4px; }
    </style>
</head>
<body>

    <h1>Costco Gold Tracker</h1>
    <p>Target: 1oz PAMP Suisse Lady Fortuna</p>
    
    <button onclick="checkNow()">Check Availability & Price</button>

    <div id="result">Click the button to check...</div>

    <script>
        async function checkNow() {
            const display = document.getElementById('result');
            display.innerHTML = "Checking Costco... please wait...";

            const targetUrl = "https://www.costco.com/1-oz-gold-bar-pamp-suisse-lady-fortuna-veriscan-new-in-assay.product.4000363990.html";
            
            // Using a different proxy for better compatibility
            const proxyUrl = `https://corsproxy.io/?${encodeURIComponent(targetUrl)}`;

            try {
                const response = await fetch(proxyUrl);
                const html = await response.text();

                // 1. Check for "Out of Stock" text
                const outOfStock = html.includes("Out of Stock") || html.includes("Product Not Found");
                
                // 2. Try to find price (looking for $ followed by numbers)
                const priceMatch = html.match(/\$[0-9]{1,3}(,[0-9]{3})*(\.[0-9]{2})?/);
                const price = priceMatch ? priceMatch[0] : "Price Hidden (Login Required)";

                if (outOfStock) {
                    display.innerHTML = `<div class="out-of-stock">OUT OF STOCK</div><p>Checked at: ${new Date().toLocaleTimeString()}</p>`;
                } else {
                    display.innerHTML = `
                        <div class="in-stock">IN STOCK!</div>
                        <div style="font-size: 24px; margin: 10px;">Price: ${price}</div>
                        <a href="${targetUrl}" target="_blank">Go to Costco.com</a>
                    `;
                }
            } catch (error) {
                display.innerHTML = "Error: Could not reach Costco. The site might be blocking the request.";
                console.error(error);
            }
        }
    </script>
</body>
</html>
